<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>Babel: a Dictionary for Panhuman Image-Based Language</title>
		<script src="http://code.jquery.com/jquery-1.8.1.min.js"></script>
		<script>
			if(localStorage.twitterSearch) {//twitterSearch is a property of localStorage; can be named anything
				var twitterData = JSON.parse(localStorage.twitterSearch),
					formattedData = [];
				$.each(twitterData.results, function(index, tweet) {
					var id = tweet.id;
					var text = tweet.text;
					window.term = tweet.text;
					var author = tweet.from_username;
					formattedData.push({ //save only the data you want
						id: id,
						text: text,
						author: author
					});
				});
				localStorage.formattedData = JSON.stringify(formattedData);
				
			} else { //if the information does not exist in the cache, do this (add it, which is defined in the success property function)
				var data;
				$.ajax({
					url: 'http://search.twitter.com/search.json?q=%E3%82%B7%20OR%20%E3%81%A3%20OR%20%E3%83%8F%20OR%20%E3%81%A1%20OR%20(%E0%AB%80%20OR%20%E3%81%93%20OR%20%E0%B1%AA%20OR%20%E2%97%9E%E0%B8%B4%20OR%20%E2%97%9F%E0%B8%B4%20OR%20%E2%9A%97%E0%B8%B1%20lang%3Aen&rpp=1',
					dataType:'jsonp',
					success:function(response) {//has to be called "response"
						localStorage.twitterSearch = JSON.stringify(response); //response has to be wrapped in this to convert the object to a string
					},
					error: function(error){//should pass the actual error that was encountered
						console.log(error);
					}
				});	
			}
			//Get google images
			if(localStorage.imageSearch) {
				var imageResults = JSON.parse(localStorage.imageSearch),
					formattedImages = [];
				$.each(imageResults.items, function(index, value) {
					var imgUrl = value.link;
					formattedImages.push({
						imgUrl : imgUrl
					});
				});
				console.log(imageResults);
				localStorage.formattedImages = JSON.stringify(formattedImages);
			} else {
				var query = "nyc";
				$.ajax({
					url: 'https://www.googleapis.com/customsearch/v1?key=AIzaSyC3j0IL8MvOHlnJyxlvVBtV516H_GWm9w0&cx=013127619618331965896:basxoxgd-ce&q='+query+'&searchType=image',
					dataType:'jsonp',
					success:function(response){
						localStorage.imageSearch = JSON.stringify(response);
						console.log(response);
					}
				});
			}
			
			// THIS CODE DOES NOT ACCOUNT FOR GOOGLE IMAGE SEARCHES THAT RETURN NO RESULTS. IT JUST BREAKS THE WEBSITE
   		</script>
	</head>
	<body>
		
		<div id="content">
			
		</div>
	</body>
</html>